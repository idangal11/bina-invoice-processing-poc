# Bina Project â€“ Invoice Processing System

## Overview
This project demonstrates two different approaches for extracting structured invoice data from PDF files and exporting the results to Excel:
1. A **Low-Code Workflow Automation** approach using **n8n**
2. A **Code-First** approach using **Python + LangChain**

Both approaches solve the same problem but target different use cases, skill sets, and scalability requirements.

---

## Problem Definition
Invoices are typically received as unstructured PDF documents.  
The goal of this project is to:
- Extract invoice text from PDF files
- Convert the unstructured content into **structured JSON**
- Export the structured data into **Excel format**
- Compare two architectural approaches for solving this task

---

## Approach 1: Low-Code / Workflow Automation (n8n)

### Description
This approach uses **n8n**, a low-code workflow automation platform, to orchestrate the entire pipeline visually.  
It focuses on fast development, transparency, and ease of maintenance.

### Architecture
1. Manual trigger to start the workflow
2. Download invoice PDF
3. Extract text from the PDF
4. Use an LLM (Claude via Anthropic API) to extract structured invoice data
5. Split line items into separate rows
6. Convert the final structured data into an Excel (XLSX) file

### Technologies
- n8n
- Anthropic Claude (LLM)
- PDF text extraction
- JSON transformation
- Excel (XLSX) export

### How to Run
1. Import the provided n8n workflow JSON into your n8n instance
2. Configure the Anthropic API key
3. Execute the workflow manually
4. Download the generated Excel file

---

## Approach 2: Code-First (Python + LangChain)

### Description
This approach uses Python and LangChain to build a fully programmable pipeline.  
It emphasizes flexibility, advanced logic, and extensibility.

### Architecture
1. Load PDF files using PyPDFLoader
2. Extract raw text from invoices
3. Use LangChain with an LLM for structured information extraction
4. Enforce output schema using Pydantic / Structured Output Parsers
5. Export structured results to Excel using pandas

### Technologies
- Python
- LangChain
- PyPDFLoader
- Pydantic
- pandas
- Excel (XLSX) export

### How to Run (CLI)
```bash
pip install -r requirements.txt
python main.py
```

---

## Graphical User Interface (GUI)

### Description
The project includes an optional **GUI interface** for running the invoice extraction pipeline interactively.
The GUI is intended for:
- Manual testing and demonstrations
- Non-technical users
- Easier PDF selection without using the terminal

### How to Run (GUI)
```bash
python ui.py
```

### GUI Capabilities
- Select one or more invoice PDF files
- Trigger the extraction pipeline
- View processing status
- Generate the same structured Excel output as the CLI version

---

## Configuration (.env)

### Setup
1. Copy the example configuration file:
```bash
cp .env.example .env
```

2. Edit `.env` and set the required values.

### Example `.env.example`
```env
USE_LLM=true
LLM_MODEL=claude-3-5-haiku-20241022
ANTHROPIC_API_KEY=YOUR_ANTHROPIC_API_KEY_HERE
```

- Setting `USE_LLM=false` runs the system in mock/deterministic mode.
- When `USE_LLM=true`, the pipeline uses Anthropic Claude for structured extraction.

---

## Comparison: n8n vs LangChain

| Aspect | n8n (Low-Code) | LangChain (Code-First) |
|------|---------------|------------------------|
| Development Speed | Very fast | Moderate |
| Flexibility | Medium | High |
| Scalability | Medium | High |
| Debugging | Visual | Code-based |
| Required Expertise | Low | High |
| Best Use Case | Business workflows, automation | Complex logic, research, production systems |

---

## Deliverables
- n8n workflow JSON export
- Python + LangChain implementation
- Excel output files
- This README document

---

## Final Notes
Both approaches are valid and production-capable.  
The choice depends on project constraints, team skills, and long-term maintenance considerations.

## Additional Documentation

- **Architecture Overview**: see `ARCHITECTURE.md`
- **System Specification**: see `SPECIFICATION.md`

Note: memory_bank.json (langchain_pipeline) is a runtime artifact generated by the pipeline.

### Google Drive Integration
The Google Drive API is used only in the n8n-based approach.
Credentials are not included in this repository for security reasons.
To run the workflow, users should configure their own Google Drive credentials in n8n.

